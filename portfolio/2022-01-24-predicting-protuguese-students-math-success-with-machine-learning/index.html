<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HAYLEY ZORKIC</title>
<meta name="description" content="The Personal Website of Hayley Zorkic">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://hzorkic.github.io/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="https://hzorkic.github.io/css/font-awesome.min.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.carousel.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.theme.css">


  <link href="https://hzorkic.github.io/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://hzorkic.github.io/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://hzorkic.github.io/img/aobut.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-EGR7PE3Y44', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    
    <img style="border: solid 2px black; border-radius: 50%; max-width: 90%; height: auto;" src="/img/1_about.jpg" alt="">
    <h1></h1>
    
    <h1 class="sidebar-heading"><a href="https://hzorkic.github.io/">HAYLEY ZORKIC</a></h1>
    
      <p class="sidebar-p">Data Scientist. Researcher.</p>
    
    
    <ul class="sidebar-menu">
      
        <li><a href="https://hzorkic.github.io/about/">About</a></li>
      
        <li><a href="https://hzorkic.github.io/portfolio/">Technical</a></li>
      
        <li><a href="https://hzorkic.github.io/creative/">Creative</a></li>
      
        <li><a href="https://hzorkic.github.io/img/RESUME.pdf">CV</a></li>
      
    </ul>
    
    <p class="social">
  
  
  
  
  
  <a href="mailto:hayley.zorkic@gmail.com" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/hayley-zorkic" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/hzorkic" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
</p>

    <p><sub><i> Note: Some posts are under construction and subject to change. </i></sub></p>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs ">
  
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left">
    <i class="fa fa-bars"></i>
  </button>

  <h1 class="small-navbar-heading"><a href="https://hzorkic.github.io/">HAYLEY ZORKIC</a></h1>
  
</div>


  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Predicting Portuguese Students Math Success with Machine Learning</h1>
         <h5>
            Posted on Jan 24, 2022 - 
            <i class="fa fa-clock-o"></i> 
           6 min read 
        </h5>
         <h2 id="introduction">Introduction</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#Pandas and numpy for data manipulation</span>

<span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd

<span style="color:#75715e"># Matplot lib and seaborn for visualizations</span>

<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt 
<span style="color:#f92672">%</span>matplotlib inline
plt<span style="color:#f92672">.</span>rcParams[<span style="color:#e6db74">&#39;figure.dpi&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>

<span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns 

<span style="color:#75715e"># Standard machine learning models</span>
<span style="color:#f92672">from</span> sklearn.linear_model <span style="color:#f92672">import</span> LogisticRegression
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
<span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> svm

<span style="color:#75715e"># Scikit-learn utilities</span>

<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report, confusion_matrix,accuracy_score, roc_curve, auc
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV

<span style="color:#f92672">from</span> warnings <span style="color:#f92672">import</span> filterwarnings
filterwarnings(<span style="color:#e6db74">&#39;ignore&#39;</span>)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Read in the csv</span>
datafile <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;student-mat.csv&#39;</span>
data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(
    filepath_or_buffer<span style="color:#f92672">=</span>datafile,
    delimiter<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>)

<span style="color:#75715e"># select features we will be using</span>
features <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;G3&#39;</span>, <span style="color:#e6db74">&#39;school&#39;</span>, <span style="color:#e6db74">&#39;sex&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>, <span style="color:#e6db74">&#39;Pstatus&#39;</span>, \
            <span style="color:#e6db74">&#39;Medu&#39;</span>, <span style="color:#e6db74">&#39;Fedu&#39;</span>, <span style="color:#e6db74">&#39;studytime&#39;</span>, <span style="color:#e6db74">&#39;failures&#39;</span>,<span style="color:#e6db74">&#39;schoolsup&#39;</span>, \
            <span style="color:#e6db74">&#39;activities&#39;</span>, <span style="color:#e6db74">&#39;health&#39;</span>, <span style="color:#e6db74">&#39;absences&#39;</span>, \
            <span style="color:#e6db74">&#39;higher&#39;</span>, <span style="color:#e6db74">&#39;internet&#39;</span>,<span style="color:#e6db74">&#39;freetime&#39;</span>]

<span style="color:#75715e"># slice df with just the features we want to analyze</span>
df <span style="color:#f92672">=</span> data[features]

<span style="color:#75715e"># preview data</span>
df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Check to see if we have the correct number of features</span>
<span style="color:#75715e"># Check to see how many students we have</span>

print(<span style="color:#e6db74">&#39;Features :&#39;</span>, df<span style="color:#f92672">.</span>columns)
print(<span style="color:#e6db74">&#39;&#39;</span>)
print(<span style="color:#e6db74">&#39;Total number of students in our dataset is N : %0.f&#39;</span> <span style="color:#f92672">%</span> df<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>])
</code></pre></div><pre><code>Features : Index(['G3', 'school', 'sex', 'age', 'Pstatus', 'Medu', 'Fedu', 'studytime',
       'failures', 'schoolsup', 'activities', 'health', 'absences', 'higher',
       'internet', 'freetime'],
      dtype='object')

Total number of students in our dataset is N : 395
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Rename our G3 (final grade) </span>
df<span style="color:#f92672">.</span>rename(columns<span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;G3&#39;</span>:<span style="color:#e6db74">&#39;Success&#39;</span>},  inplace <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
df[<span style="color:#e6db74">&#39;Success&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Success&#39;</span>]<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span> <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># male is 1, female is 0</span>
df<span style="color:#f92672">.</span>sex[df<span style="color:#f92672">.</span>sex <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;M&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
df<span style="color:#f92672">.</span>sex[df<span style="color:#f92672">.</span>sex <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;F&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

df[<span style="color:#e6db74">&#39;schoolsup&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;schoolsup&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;yes&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;no&#39;</span>: <span style="color:#ae81ff">0</span>})
df[<span style="color:#e6db74">&#39;activities&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;activities&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;yes&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;no&#39;</span>: <span style="color:#ae81ff">0</span>})
df[<span style="color:#e6db74">&#39;higher&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;higher&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;yes&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;no&#39;</span>: <span style="color:#ae81ff">0</span>})
df[<span style="color:#e6db74">&#39;internet&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;internet&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;yes&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;no&#39;</span>: <span style="color:#ae81ff">0</span>})
df[<span style="color:#e6db74">&#39;Pstatus&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;Pstatus&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;T&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;A&#39;</span>: <span style="color:#ae81ff">0</span>})
df[<span style="color:#e6db74">&#39;school&#39;</span>] <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;school&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;GP&#39;</span>: <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;MS&#39;</span>: <span style="color:#ae81ff">0</span>})


df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt

<span style="color:#75715e"># Pie chart, where the slices will be ordered and plotted counter-clockwise:</span>
labels <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Sufficient Academic Performance&#39;</span>, <span style="color:#e6db74">&#39;Poor Academic Performance&#39;</span>]
sizes <span style="color:#f92672">=</span> [len(df[df[<span style="color:#e6db74">&#39;Success&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>] ), len(df[df[<span style="color:#e6db74">&#39;Success&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>] )]

fig1, ax1 <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots()
ax1<span style="color:#f92672">.</span>pie(sizes, labels<span style="color:#f92672">=</span>labels, autopct<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%1.1f%%</span><span style="color:#e6db74">&#39;</span>,
        shadow<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, startangle<span style="color:#f92672">=</span><span style="color:#ae81ff">90</span>)
ax1<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#39;equal&#39;</span>)  <span style="color:#75715e"># Equal aspect ratio ensures that pie is drawn as a circle.</span>

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="./Math_Success_Portugal_5_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">corr <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>corr()
g <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>heatmap(corr,  vmax<span style="color:#f92672">=</span><span style="color:#ae81ff">.3</span>, center<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>,
            square<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, linewidths<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>, cbar_kws<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;shrink&#34;</span>: <span style="color:#ae81ff">.5</span>}, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.2f&#39;</span>, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;coolwarm&#39;</span>)
sns<span style="color:#f92672">.</span>despine()
g<span style="color:#f92672">.</span>figure<span style="color:#f92672">.</span>set_size_inches(<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">10</span>)
    
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="./Math_Success_Portugal_6_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># PCA </span>
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
<span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> StandardScaler

scaler<span style="color:#f92672">=</span>StandardScaler()
scaler<span style="color:#f92672">.</span>fit(df)

scaled_data<span style="color:#f92672">=</span>scaler<span style="color:#f92672">.</span>transform(df)
<span style="color:#f92672">from</span> sklearn.decomposition <span style="color:#f92672">import</span> PCA
pca<span style="color:#f92672">=</span>PCA(n_components<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
pca<span style="color:#f92672">.</span>fit(scaled_data)

x_pca<span style="color:#f92672">=</span>pca<span style="color:#f92672">.</span>transform(scaled_data)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">6</span>))
plt<span style="color:#f92672">.</span>scatter(x_pca[:,<span style="color:#ae81ff">0</span>],x_pca[:,<span style="color:#ae81ff">1</span>],c<span style="color:#f92672">=</span>df[<span style="color:#e6db74">&#39;Success&#39;</span>])

plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;First principle component&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Second principle component&#39;</span>)
</code></pre></div><pre><code>Text(0, 0.5, 'Second principle component')
</code></pre>
<p><img src="./Math_Success_Portugal_7_1.png" alt="png"></p>
<h3 id="training-and-testing">Training and Testing</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">use_features <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;school&#39;</span>, <span style="color:#e6db74">&#39;sex&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>, <span style="color:#e6db74">&#39;Pstatus&#39;</span>, \
            <span style="color:#e6db74">&#39;Medu&#39;</span>, <span style="color:#e6db74">&#39;Fedu&#39;</span>, <span style="color:#e6db74">&#39;studytime&#39;</span>, <span style="color:#e6db74">&#39;failures&#39;</span>,<span style="color:#e6db74">&#39;schoolsup&#39;</span>, \
            <span style="color:#e6db74">&#39;activities&#39;</span>, <span style="color:#e6db74">&#39;health&#39;</span>, <span style="color:#e6db74">&#39;absences&#39;</span>, \
            <span style="color:#e6db74">&#39;higher&#39;</span>, <span style="color:#e6db74">&#39;internet&#39;</span>,<span style="color:#e6db74">&#39;freetime&#39;</span>]
target <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;Success&#34;</span>]

X <span style="color:#f92672">=</span> df[use_features]
y <span style="color:#f92672">=</span> df[target]

<span style="color:#75715e"># Split into training and testing sets using 30% of our observations for testing</span>
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X,y, test_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.3</span>, random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># Scale the data </span>
sc <span style="color:#f92672">=</span> StandardScaler()

X_train <span style="color:#f92672">=</span> sc<span style="color:#f92672">.</span>fit_transform(X_train)
X_test <span style="color:#f92672">=</span> sc<span style="color:#f92672">.</span>transform(X_test)

print(X_train<span style="color:#f92672">.</span>shape)
print(X_test<span style="color:#f92672">.</span>shape)


</code></pre></div><pre><code>(276, 15)
(119, 15)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y_train[<span style="color:#e6db74">&#39;Success&#39;</span>]<span style="color:#f92672">.</span>value_counts()
</code></pre></div><pre><code>1    156
0    120
Name: Success, dtype: int64
</code></pre>
<h4 id="baseline-model">Baseline Model</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Calculate the accuracy and classification report of our model</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_metrics</span>(y_true, y_pred):
    cr <span style="color:#f92672">=</span> classification_report(y_test, y_pred)
    ac <span style="color:#f92672">=</span> accuracy_score(y_test, y_pred)
    print(<span style="color:#e6db74">&#39;The classification report : &#39;</span>)
    print(<span style="color:#e6db74">&#39;&#39;</span>)
    print(cr)
    print(<span style="color:#e6db74">&#39;&#39;</span>)
    print(<span style="color:#e6db74">&#39;Accuracy of Model: </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">%&#39;</span><span style="color:#f92672">.</span>format(<span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> ac))
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Make naive baseline and evaluate metrics</span>
baseline_pred <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(len(y_test))]
calc_metrics(y_test, baseline_pred)
</code></pre></div><pre><code>The classification report : 

              precision    recall  f1-score   support

           0       0.00      0.00      0.00        66
           1       0.45      1.00      0.62        53

    accuracy                           0.45       119
   macro avg       0.22      0.50      0.31       119
weighted avg       0.20      0.45      0.27       119


Accuracy of Model: 44.54%
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Visualizes a confusion matrix as a plot</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_confusion_matrix</span>(cm):

    <span style="color:#75715e"># Display the matrix in text form</span>
    print(<span style="color:#e6db74">&#39;Confusion matrix&#39;</span>)
    print(cm)
    
    <span style="color:#75715e"># we use a heatmap from the seaborn plot.</span>

    ax <span style="color:#f92672">=</span> sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, cbar<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;g&#39;</span>)
    ax<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Confusion Matrix&#39;</span>)
    ax<span style="color:#f92672">.</span>set_xticklabels([<span style="color:#e6db74">&#39;Failing Students&#39;</span>, <span style="color:#e6db74">&#39;Suceeding Students&#39;</span>],
                       fontsize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;x-small&#39;</span>, rotation<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>)
    ax<span style="color:#f92672">.</span>set_yticklabels([<span style="color:#e6db74">&#39;Failing Students&#39;</span>, <span style="color:#e6db74">&#39;Suceeding Students&#39;</span>],
                       fontsize<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;x-small&#39;</span>, va<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;center&#34;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Actual Value&#39;</span>)
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Predicted Value&#39;</span>)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm <span style="color:#f92672">=</span> confusion_matrix(y_test, baseline_pred)
plot_confusion_matrix(cm)
</code></pre></div><pre><code>Confusion matrix
[[ 0 66]
 [ 0 53]]
</code></pre>
<p><img src="./Math_Success_Portugal_15_1.png" alt="png"></p>
<h3 id="standard-ml-methods">Standard ML Methods</h3>
<h4 id="logistic-regression">Logistic Regression</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Make logistic regression model and fit</span>

lr <span style="color:#f92672">=</span> LogisticRegression()
lr<span style="color:#f92672">.</span>fit(X_train, y_train)

<span style="color:#75715e"># make predictions and evaluate</span>

lr_pred <span style="color:#f92672">=</span> lr<span style="color:#f92672">.</span>predict(X_test)
calc_metrics(y_test, lr_pred)
</code></pre></div><pre><code>The classification report : 

              precision    recall  f1-score   support

           0       0.83      0.45      0.59        66
           1       0.57      0.89      0.69        53

    accuracy                           0.65       119
   macro avg       0.70      0.67      0.64       119
weighted avg       0.71      0.65      0.63       119


Accuracy of Model: 64.71%
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Determine The roc curve and the auc and display</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calc_roc</span>(y_test, prob_predict,model_name):
    
    lr_predict_probabilities <span style="color:#f92672">=</span> prob_predict

    lr_fpr, lr_tpr, _ <span style="color:#f92672">=</span> roc_curve(y_test, lr_predict_probabilities)
    lr_roc_auc <span style="color:#f92672">=</span> auc(lr_fpr, lr_tpr)

    plt<span style="color:#f92672">.</span>figure()
    plt<span style="color:#f92672">.</span>plot(lr_fpr, lr_tpr, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;darkgreen&#39;</span>,
         lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> (area = </span><span style="color:#e6db74">%0.2f</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (model_name,lr_roc_auc))
    plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;navy&#39;</span>, lw<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
    plt<span style="color:#f92672">.</span>xlim([<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>])
    plt<span style="color:#f92672">.</span>ylim([<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.05</span>])
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>)
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Reciever Operating Characteristic Curve Curve, AUC = </span><span style="color:#e6db74">%.4f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> lr_roc_auc)
    plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lower right&#34;</span>)
    plt<span style="color:#f92672">.</span>show()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ROC for Logistic Regression</span>
lr_pred_proba <span style="color:#f92672">=</span> lr<span style="color:#f92672">.</span>predict_proba(X_test)[:, <span style="color:#ae81ff">1</span>]
calc_roc(y_test,lr_pred_proba,<span style="color:#e6db74">&#39;Logistic Regression&#39;</span>)
</code></pre></div><p><img src="./Math_Success_Portugal_20_0.png" alt="png"></p>
<h3 id="random-forest">Random Forest</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Create and fit the random forest</span>
regressor <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">40</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
regressor<span style="color:#f92672">.</span>fit(X_train, y_train<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>ravel())


<span style="color:#75715e"># Evaluate predictions</span>
y_pred <span style="color:#f92672">=</span> regressor<span style="color:#f92672">.</span>predict(X_test)
calc_metrics(y_test,y_pred)
</code></pre></div><pre><code>The classification report : 

              precision    recall  f1-score   support

           0       0.74      0.53      0.62        66
           1       0.57      0.77      0.66        53

    accuracy                           0.64       119
   macro avg       0.66      0.65      0.64       119
weighted avg       0.67      0.64      0.64       119


Accuracy of Model: 63.87%
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Confusion Matrix For Random Forest</span>
cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred)
plot_confusion_matrix(cm)
</code></pre></div><pre><code>Confusion matrix
[[35 31]
 [12 41]]
</code></pre>
<p><img src="./Math_Success_Portugal_23_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ROC for Random Forest</span>
rf_predict <span style="color:#f92672">=</span> regressor<span style="color:#f92672">.</span>predict_proba(X_test)[:,<span style="color:#ae81ff">1</span>]
calc_roc(y_test,rf_predict,<span style="color:#e6db74">&#39;Random Forest&#39;</span>)
</code></pre></div><p><img src="./Math_Success_Portugal_24_0.png" alt="png"></p>
<h4 id="grid-search-random-forest">Grid Search Random Forest</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># We will use GridSearch to find the best parameters for this model</span>

gridsearch_forest <span style="color:#f92672">=</span> RandomForestClassifier()

params <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#34;n_estimators&#34;</span>: [<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">500</span>],
    <span style="color:#e6db74">&#34;max_depth&#34;</span>: [<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>],
    <span style="color:#e6db74">&#34;min_samples_leaf&#34;</span> : [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>]
}

clf <span style="color:#f92672">=</span> GridSearchCV(gridsearch_forest, param_grid<span style="color:#f92672">=</span>params, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> )
clf<span style="color:#f92672">.</span>fit(X,y<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>ravel())
</code></pre></div><pre><code>GridSearchCV(cv=5, estimator=RandomForestClassifier(),
             param_grid={'max_depth': [5, 8, 15], 'min_samples_leaf': [1, 2, 4],
                         'n_estimators': [100, 300, 500]})
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">clf<span style="color:#f92672">.</span>best_params_
</code></pre></div><pre><code>{'max_depth': 5, 'min_samples_leaf': 4, 'n_estimators': 300}
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Create and fit the random forest</span>
regressor <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>, max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>, 
                                   min_samples_leaf <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
regressor<span style="color:#f92672">.</span>fit(X_train, y_train<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>ravel())

<span style="color:#75715e"># Evaluate predictions</span>
y_pred <span style="color:#f92672">=</span> regressor<span style="color:#f92672">.</span>predict(X_test)
calc_metrics(y_test,y_pred)
</code></pre></div><pre><code>The classification report : 

              precision    recall  f1-score   support

           0       0.85      0.44      0.58        66
           1       0.56      0.91      0.70        53

    accuracy                           0.65       119
   macro avg       0.71      0.67      0.64       119
weighted avg       0.72      0.65      0.63       119


Accuracy of Model: 64.71%
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Confusion Matrix For Random Forest</span>
cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred)
plot_confusion_matrix(cm)
</code></pre></div><pre><code>Confusion matrix
[[29 37]
 [ 5 48]]
</code></pre>
<p><img src="./Math_Success_Portugal_29_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ROC for Random Forest</span>
rf_predict <span style="color:#f92672">=</span> regressor<span style="color:#f92672">.</span>predict_proba(X_test)[:,<span style="color:#ae81ff">1</span>]
calc_roc(y_test,rf_predict,<span style="color:#e6db74">&#39;Random Forest&#39;</span>)
</code></pre></div><p><img src="./Math_Success_Portugal_30_0.png" alt="png"></p>
<h3 id="support-vector-machine">Support Vector Machine</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Create and fit SVM</span>
clf <span style="color:#f92672">=</span> svm<span style="color:#f92672">.</span>SVC(class_weight <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;balanced&#39;</span>,
              probability <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
clf<span style="color:#f92672">.</span>fit(X_train, y_train<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>ravel())


<span style="color:#75715e"># Evaluate predictions</span>
y_pred <span style="color:#f92672">=</span> clf<span style="color:#f92672">.</span>predict(X_test)
calc_metrics(y_test,y_pred)
</code></pre></div><pre><code>The classification report : 

              precision    recall  f1-score   support

           0       0.76      0.56      0.64        66
           1       0.59      0.77      0.67        53

    accuracy                           0.66       119
   macro avg       0.67      0.67      0.66       119
weighted avg       0.68      0.66      0.65       119


Accuracy of Model: 65.55%
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Confusion Matrix For Support Vector Machine</span>
cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred)
plot_confusion_matrix(cm)
</code></pre></div><pre><code>Confusion matrix
[[37 29]
 [12 41]]
</code></pre>
<p><img src="./Math_Success_Portugal_33_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ROC for SVM</span>
svm_predicta <span style="color:#f92672">=</span> clf<span style="color:#f92672">.</span>predict_proba(X_test)[:,<span style="color:#ae81ff">1</span>]
calc_roc(y_test,svm_predicta,<span style="color:#e6db74">&#39;Support Vector Machine&#39;</span>)
</code></pre></div><p><img src="./Math_Success_Portugal_34_0.png" alt="png"></p>
<h3 id="conclusions">Conclusions</h3>
<p>Luckily, all of these models perform better than the base model!</p>
<p>Base Model:
AUC 44.45%
F1 0.27</p>
<p>Logistic Regression:
AUC 64.71%
F1 0.63</p>
<p>Random Forest:
AUC 63.87%
F1 0.64</p>
<p>Grid Search RF:
AUC 64.71%
F1 0.63</p>
<p>SVM:
AUC 65.55%
F1 0.65</p>
<h3 id="next-steps-">Next Steps ?</h3>
<p>Which variables affect the Success most?</p>
<p>Can we add back more variables from the original dataset?</p>
<p>Can we more carefully select a model based on its pros/cons rather than simply throwing multiple models at it?</p>
<p>Though this contradicts the last point, can we use Neural Networks to classify Success?</p>
<p>Can we reccomend things to change for students who are performing poorly?</p>
<p><img src="/img/under_construction.png" alt=""></p>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="https://hzorkic.github.io/js/jquery.min.js"></script>
<script src="https://hzorkic.github.io/js/bootstrap.min.js"></script>
<script src="https://hzorkic.github.io/js/jquery.cookie.js"> </script>
<script src="https://hzorkic.github.io/js/ekko-lightbox.js"></script>
<script src="https://hzorkic.github.io/js/jquery.scrollTo.min.js"></script>
<script src="https://hzorkic.github.io/js/masonry.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/imagesloaded.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/owl.carousel.min.js"></script>
<script src="https://hzorkic.github.io/js/front.js"></script>



</body>
</html>
