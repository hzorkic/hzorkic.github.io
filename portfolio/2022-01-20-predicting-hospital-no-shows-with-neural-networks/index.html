<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>HAYLEY ZORKIC</title>
<meta name="description" content="The Personal Website of Hayley Zorkic">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://hzorkic.github.io/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="https://hzorkic.github.io/css/font-awesome.min.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.carousel.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.theme.css">


  <link href="https://hzorkic.github.io/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://hzorkic.github.io/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://hzorkic.github.io/img/aobut.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-EGR7PE3Y44', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    
    <img style="border: solid 2px black; border-radius: 50%; max-width: 90%; height: auto;" src="/img/1_about.jpg" alt="">
    <h1></h1>
    
    <h1 class="sidebar-heading"><a href="https://hzorkic.github.io/">HAYLEY ZORKIC</a></h1>
    
      <p class="sidebar-p">Data Scientist. Researcher.</p>
    
    
    <ul class="sidebar-menu">
      
        <li><a href="https://hzorkic.github.io/about/">About</a></li>
      
        <li><a href="https://hzorkic.github.io/portfolio/">Technical</a></li>
      
        <li><a href="https://hzorkic.github.io/creative/">Creative</a></li>
      
        <li><a href="https://hzorkic.github.io/img/RESUME.pdf">CV</a></li>
      
    </ul>
    
    <p class="social">
  
  
  
  
  
  <a href="mailto:hayley.zorkic@gmail.com" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/hayley-zorkic" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/hzorkic" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
</p>

    <p><sub><i> Note: Some posts are under construction and subject to change. </i></sub></p>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs ">
  
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left">
    <i class="fa fa-bars"></i>
  </button>

  <h1 class="small-navbar-heading"><a href="https://hzorkic.github.io/">HAYLEY ZORKIC</a></h1>
  
</div>


  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Predicting Hospital No-Shows with Neural Networks</h1>
         <h5>
            Posted on Jan 20, 2022 - 
            <i class="fa fa-clock-o"></i> 
           7 min read 
        </h5>
         <p>Let&rsquo;s use machine learning to figure out why 30% of patients miss their scheduled appointments!</p>
<p>This project will be orgnaized as such:</p>
<ol>
<li>Collect Data</li>
<li>Data Preprocessing</li>
<li>EDA</li>
<li>Model Buidling</li>
<li>Conclusions</li>
</ol>
<h2 id="1-collect-data">1. Collect Data</h2>
<p>Because I do not readily have access to my own data, for this project, we will be using Kaggle&rsquo;s &ldquo;Medical Appointment No Shows.&rdquo; You can <a href="https://www.kaggle.com/joniarroba/noshowappointments">download the file here</a> if you want to follow along with this code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import out necessary libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># read the data</span>
</span></span><span style="display:flex;"><span>noShows <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;KaggleV2-May-2016.csv&#39;</span>)
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h2 id="2-data-preprocessing">2. Data Preprocessing</h2>
<p>You can read a bit more about the importance of data preprocessing <a href="https://medium.com/swlh/data-pre-processing-data-wrangling-4a6a8624e747">here</a>.</p>
<p>First, lets take a look at what were working with:</p>
<p>2.1 Clean Data</p>
<p>There are a few housekeeping taks we need to perform based on the data head, such as:</p>
<ul>
<li>correcting some spelling</li>
<li>dropping columns with no value</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Correcting a few spelling errors in the original table</span>
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>rename(columns <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;Hipertension&#39;</span>: <span style="color:#e6db74">&#39;Hypertension&#39;</span>,
</span></span><span style="display:flex;"><span>                         <span style="color:#e6db74">&#39;Handcap&#39;</span>: <span style="color:#e6db74">&#39;Handicap&#39;</span>}, inplace <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Tidying the table by dropping useless columns</span>
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;PatientId&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;AppointmentID&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, inplace <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Checking for NaNs and outliers</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Age:&#39;</span>,sorted(noShows<span style="color:#f92672">.</span>Age<span style="color:#f92672">.</span>unique()))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Gender:&#39;</span>,noShows<span style="color:#f92672">.</span>Gender<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Diabetes:&#39;</span>,noShows<span style="color:#f92672">.</span>Diabetes<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Alchoholism:&#39;</span>,noShows<span style="color:#f92672">.</span>Alcoholism<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Hypertension:&#39;</span>,noShows<span style="color:#f92672">.</span>Hypertension<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Handicap:&#39;</span>,noShows<span style="color:#f92672">.</span>Handicap<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Scholarship:&#39;</span>,noShows<span style="color:#f92672">.</span>Scholarship<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;SMS_received:&#39;</span>,noShows<span style="color:#f92672">.</span>SMS_received<span style="color:#f92672">.</span>unique())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Neighbourhood:&#39;</span>,noShows<span style="color:#f92672">.</span>Neighbourhood<span style="color:#f92672">.</span>unique())
</span></span></code></pre></div><pre><code>Age: [-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 102, 115]
Gender: ['F' 'M']
Diabetes: [0 1]
Alchoholism: [0 1]
Hypertension: [1 0]
Handicap: [0 1 2 3 4]
Scholarship: [0 1]
SMS_received: [0 1]
Neighbourhood: ['JARDIM DA PENHA' 'MATA DA PRAIA' 'PONTAL DE CAMBURI' 'REPÚBLICA'
 'GOIABEIRAS' 'ANDORINHAS' 'CONQUISTA' 'NOVA PALESTINA' 'DA PENHA'
 'TABUAZEIRO' 'BENTO FERREIRA' 'SÃO PEDRO' 'SANTA MARTHA' 'SÃO CRISTÓVÃO'
 'MARUÍPE' 'GRANDE VITÓRIA' 'SÃO BENEDITO' 'ILHA DAS CAIEIRAS'
 'SANTO ANDRÉ' 'SOLON BORGES' 'BONFIM' 'JARDIM CAMBURI' 'MARIA ORTIZ'
 'JABOUR' 'ANTÔNIO HONÓRIO' 'RESISTÊNCIA' 'ILHA DE SANTA MARIA'
 'JUCUTUQUARA' 'MONTE BELO' 'MÁRIO CYPRESTE' 'SANTO ANTÔNIO' 'BELA VISTA'
 'PRAIA DO SUÁ' 'SANTA HELENA' 'ITARARÉ' 'INHANGUETÁ' 'UNIVERSITÁRIO'
 'SÃO JOSÉ' 'REDENÇÃO' 'SANTA CLARA' 'CENTRO' 'PARQUE MOSCOSO'
 'DO MOSCOSO' 'SANTOS DUMONT' 'CARATOÍRA' 'ARIOVALDO FAVALESSA'
 'ILHA DO FRADE' 'GURIGICA' 'JOANA D´ARC' 'CONSOLAÇÃO' 'PRAIA DO CANTO'
 'BOA VISTA' 'MORADA DE CAMBURI' 'SANTA LUÍZA' 'SANTA LÚCIA'
 'BARRO VERMELHO' 'ESTRELINHA' 'FORTE SÃO JOÃO' 'FONTE GRANDE'
 'ENSEADA DO SUÁ' 'SANTOS REIS' 'PIEDADE' 'JESUS DE NAZARETH'
 'SANTA TEREZA' 'CRUZAMENTO' 'ILHA DO PRÍNCIPE' 'ROMÃO' 'COMDUSA'
 'SANTA CECÍLIA' 'VILA RUBIM' 'DE LOURDES' 'DO QUADRO' 'DO CABRAL' 'HORTO'
 'SEGURANÇA DO LAR' 'ILHA DO BOI' 'FRADINHOS' 'NAZARETH' 'AEROPORTO'
 'ILHAS OCEÂNICAS DE TRINDADE' 'PARQUE INDUSTRIAL']
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Assuming nobody has an age of -1 year, delete this record</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Also assuming age 0 means babies</span>
</span></span><span style="display:flex;"><span>noShows <span style="color:#f92672">=</span> noShows[noShows<span style="color:#f92672">.</span>Age <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Age:&#39;</span>,sorted(noShows<span style="color:#f92672">.</span>Age<span style="color:#f92672">.</span>unique()))
</span></span></code></pre></div><pre><code>Age: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 102, 115]
</code></pre>
<p>2.2 Feature Engineering + Data Transformation</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Convert categorical variable to binary</span>
</span></span><span style="display:flex;"><span>noShows[<span style="color:#e6db74">&#39;No-show&#39;</span>] <span style="color:#f92672">=</span> noShows[<span style="color:#e6db74">&#39;No-show&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;Yes&#39;</span>:<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;No&#39;</span>:<span style="color:#ae81ff">0</span>})
</span></span><span style="display:flex;"><span>noShows[<span style="color:#e6db74">&#39;Gender&#39;</span>] <span style="color:#f92672">=</span> noShows[<span style="color:#e6db74">&#39;Gender&#39;</span>]<span style="color:#f92672">.</span>map({<span style="color:#e6db74">&#39;F&#39;</span>:<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;M&#39;</span>:<span style="color:#ae81ff">0</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># We&#39;re only interested in the date, and not the time of day, so we&#39;ll remove the time with the below:</span>
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>ScheduledDay <span style="color:#f92672">=</span> noShows<span style="color:#f92672">.</span>ScheduledDay<span style="color:#f92672">.</span>apply(np<span style="color:#f92672">.</span>datetime64)
</span></span><span style="display:flex;"><span>noShows[<span style="color:#e6db74">&#39;ScheduledDay&#39;</span>] <span style="color:#f92672">=</span> noShows[<span style="color:#e6db74">&#39;ScheduledDay&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>date
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Converting date columns into datetime64 datatype</span>
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>AppointmentDay <span style="color:#f92672">=</span> noShows<span style="color:#f92672">.</span>AppointmentDay<span style="color:#f92672">.</span>apply(np<span style="color:#f92672">.</span>datetime64)
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>ScheduledDay <span style="color:#f92672">=</span> noShows<span style="color:#f92672">.</span>ScheduledDay<span style="color:#f92672">.</span>apply(np<span style="color:#f92672">.</span>datetime64)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Adding a column for &#39;Waiting Time&#39;</span>
</span></span><span style="display:flex;"><span>noShows[<span style="color:#e6db74">&#39;WaitingTime&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_timedelta((noShows[<span style="color:#e6db74">&#39;AppointmentDay&#39;</span>] <span style="color:#f92672">-</span> noShows[<span style="color:#e6db74">&#39;ScheduledDay&#39;</span>]))<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>days
</span></span><span style="display:flex;"><span>noShows[<span style="color:#e6db74">&#39;WaitingTime&#39;</span>] <span style="color:#f92672">=</span> noShows[<span style="color:#e6db74">&#39;WaitingTime&#39;</span>]<span style="color:#f92672">.</span>apply(np<span style="color:#f92672">.</span>int64)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create Dummy Variables for Neighborhood</span>
</span></span><span style="display:flex;"><span>dummy_cols <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Neighbourhood&#39;</span>]
</span></span><span style="display:flex;"><span>noShows <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>get_dummies(noShows, columns <span style="color:#f92672">=</span> dummy_cols)
</span></span><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>noShows<span style="color:#f92672">.</span>head()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Note: the timepoints for &#39;AppointmentDay&#39; have all dissapeared, as they were set exactly to 00:00:00</span>
</span></span></code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">NoShow and Show &#39;%&#39; of Patients</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>show <span style="color:#f92672">=</span> noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">/</span>(noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span>noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Percent of Patients who `Showed Up` =&gt; </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">%&#34;</span><span style="color:#f92672">.</span>format(show<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))
</span></span><span style="display:flex;"><span>noshow <span style="color:#f92672">=</span> noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">/</span>(noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span>noShows<span style="color:#f92672">.</span>groupby([<span style="color:#e6db74">&#39;No-show&#39;</span>])<span style="color:#f92672">.</span>size()[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Percent of Patients who Did `Not Showed Up` =&gt; </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">%&#34;</span><span style="color:#f92672">.</span>format(noshow<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))
</span></span></code></pre></div><pre><code>NoShow and Show '%' of Patients

Percent of Patients who `Showed Up` =&gt; 79.81%
Percent of Patients who Did `Not Showed Up` =&gt; 20.19%
</code></pre>
<h2 id="2-exploratory-data-analysis">2. Exploratory Data Analysis</h2>
<h2 id="3-build-model-that-predicts-if-a-patient-will-show-up-to-their-appointment">3. Build Model that Predicts if a patient will show up to their appointment</h2>
<p>3.1 Create testing and training sets.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># choose out colunms of interest</span>
</span></span><span style="display:flex;"><span>prediction_var <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;Gender&#39;</span>,<span style="color:#e6db74">&#39;Age&#39;</span>,<span style="color:#e6db74">&#39;Scholarship&#39;</span>,<span style="color:#e6db74">&#39;Hypertension&#39;</span>,<span style="color:#e6db74">&#39;Diabetes&#39;</span>,<span style="color:#e6db74">&#39;Alcoholism&#39;</span>,<span style="color:#e6db74">&#39;Handicap&#39;</span>,<span style="color:#e6db74">&#39;SMS_received&#39;</span>,<span style="color:#e6db74">&#39;WaitingTime&#39;</span>]
</span></span><span style="display:flex;"><span>noShows_drop <span style="color:#f92672">=</span> noShows[prediction_var]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span> <span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> train, test <span style="color:#f92672">=</span> train_test_split(noShows, test_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.15</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># variables used for prediciton</span>
</span></span><span style="display:flex;"><span>train_x <span style="color:#f92672">=</span> train[prediction_var]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># predicting no-shows</span>
</span></span><span style="display:flex;"><span>train_y <span style="color:#f92672">=</span> train[<span style="color:#e6db74">&#39;No-show&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># variables used for testing model </span>
</span></span><span style="display:flex;"><span>test_x <span style="color:#f92672">=</span> test[prediction_var]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># predicting no-shows</span>
</span></span><span style="display:flex;"><span>test_y <span style="color:#f92672">=</span> test[<span style="color:#e6db74">&#39;No-show&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Train set data shape: &#34;</span> <span style="color:#f92672">+</span> str(train_x<span style="color:#f92672">.</span>shape))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Test set data shape: &#34;</span> <span style="color:#f92672">+</span> str(test_x<span style="color:#f92672">.</span>shape))
</span></span></code></pre></div><pre><code>Train set data shape: (93947, 9)
Test set data shape: (16579, 9)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#f92672">=</span> train_x
</span></span><span style="display:flex;"><span>print(df[(df <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>all(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)])
</span></span></code></pre></div><pre><code>Empty DataFrame
Columns: [Gender, Age, Scholarship, Hypertension, Diabetes, Alcoholism, Handicap, SMS_received, WaitingTime]
Index: []
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> classification_report,confusion_matrix,f1_score
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">report</span>(y_test, y_pred):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Creates confusion matrix and classification report
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Args:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    y_test: splitted test dataframe labels
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    y_pred: predictions for test dataframe
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Returns:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    None
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    cm <span style="color:#f92672">=</span> confusion_matrix(y_test, y_pred)
</span></span><span style="display:flex;"><span>    sns<span style="color:#f92672">.</span>heatmap(cm, annot<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,fmt<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;d&#39;</span>,cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flare&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(classification_report(y_test,y_pred))
</span></span></code></pre></div><p>3.3 Build a DecisionTreeClassifier</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import DecisionTreeClassifier model</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#create DecisionTreeClassifier classification obj</span>
</span></span><span style="display:flex;"><span>dt_clf <span style="color:#f92672">=</span> DecisionTreeClassifier(random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#training via DecisionTreeClassifier classficiation model</span>
</span></span><span style="display:flex;"><span>dt_clf<span style="color:#f92672">.</span>fit(train_x, train_y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#make prediction using the test set</span>
</span></span><span style="display:flex;"><span>pred_y <span style="color:#f92672">=</span> dt_clf<span style="color:#f92672">.</span>predict(test_x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Feature Importance:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name, importance <span style="color:#f92672">in</span> zip(noShows_drop<span style="color:#f92672">.</span>columns, np<span style="color:#f92672">.</span>sort(dt_clf<span style="color:#f92672">.</span>feature_importances_)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> -- </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(name, importance))
</span></span></code></pre></div><pre><code>Feature Importance:

Gender -- 0.51
Age -- 0.32
Scholarship -- 0.05
Hypertension -- 0.03
Diabetes -- 0.03
Alcoholism -- 0.02
Handicap -- 0.02
SMS_received -- 0.02
WaitingTime -- 0.01
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dt_clf<span style="color:#f92672">.</span>score(test_x, test_y)
</span></span></code></pre></div><pre><code>0.7649436033536402
</code></pre>
<ol start="2">
<li>Build a RandomForestClassifier</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import RandomForestClassifier model</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#create RandomForestClassifier classification obj</span>
</span></span><span style="display:flex;"><span>rf_clf  <span style="color:#f92672">=</span> RandomForestClassifier(random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#training via RandomForestClassifier classficiation model</span>
</span></span><span style="display:flex;"><span>rf_clf<span style="color:#f92672">.</span>fit(train_x, train_y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Feature Importance:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name, importance <span style="color:#f92672">in</span> zip(noShows_drop<span style="color:#f92672">.</span>columns, np<span style="color:#f92672">.</span>sort(rf_clf<span style="color:#f92672">.</span>feature_importances_)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]):
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> -- </span><span style="color:#e6db74">{:.2f}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(name, importance))
</span></span></code></pre></div><pre><code>Feature Importance:

Gender -- 0.52
Age -- 0.40
Scholarship -- 0.02
Hypertension -- 0.02
Diabetes -- 0.01
Alcoholism -- 0.01
Handicap -- 0.01
SMS_received -- 0.01
WaitingTime -- 0.01
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>rf_clf<span style="color:#f92672">.</span>score(test_x, test_y)
</span></span></code></pre></div><pre><code>0.7663309005368237
</code></pre>
<p>Build a Neural Network to Classify</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import our model. We are using a shallow NN</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.neural_network <span style="color:#f92672">import</span> MLPClassifier
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create model + tune hyper parameters</span>
</span></span><span style="display:flex;"><span>model <span style="color:#f92672">=</span> MLPClassifier(hidden_layer_sizes<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># fit the model using the training variables + answers</span>
</span></span><span style="display:flex;"><span>model<span style="color:#f92672">.</span>fit(train_x, train_y)
</span></span></code></pre></div><pre><code>MLPClassifier(hidden_layer_sizes=(5, 2))
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># ask the model to predict the probability of no show vs NOT no show</span>
</span></span><span style="display:flex;"><span>proba_prediction <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict_proba(test_x)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># probability at each point of that patient being a no-shows</span>
</span></span><span style="display:flex;"><span>prediction <span style="color:#f92672">=</span> proba_prediction[:,<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>prediction
</span></span></code></pre></div><pre><code>array([0.3427608 , 0.26341053, 0.24750035, ..., 0.22418585, 0.30171473,
       0.02340378])
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sklearn.metrics <span style="color:#66d9ef">as</span> metrics
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> precision_score, recall_score, confusion_matrix, roc_curve, precision_recall_curve, accuracy_score
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ROCAUC</span>(test_y, prediction):
</span></span><span style="display:flex;"><span>    fpr, tpr, threshold <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>roc_curve(test_y, prediction)
</span></span><span style="display:flex;"><span>    roc_auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>auc(fpr, tpr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Receiver Operating Characteristic&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(fpr, tpr, <span style="color:#e6db74">&#39;b&#39;</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;AUC = </span><span style="color:#e6db74">%0.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> roc_auc)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend(loc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;lower right&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>],<span style="color:#e6db74">&#39;r--&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlim([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylim([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Precision-recall curve</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_precision_recall</span>():
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>step(recall, precision, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;b&#39;</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>             where <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;post&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>fill_between(recall, precision, step <span style="color:#f92672">=</span><span style="color:#e6db74">&#39;post&#39;</span>, alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>                 color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;b&#39;</span>)
</span></span><span style="display:flex;"><span>    auc <span style="color:#f92672">=</span> metrics<span style="color:#f92672">.</span>auc(recall, precision)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>plot(recall, precision, linewidth<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;AUC = </span><span style="color:#e6db74">%0.2f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> auc)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>legend(loc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;lower right&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlim([<span style="color:#ae81ff">0.0</span>,<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylim([<span style="color:#ae81ff">0.0</span>,<span style="color:#ae81ff">1.05</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Recall&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Precision&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Precision Recall Curve&#39;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show();
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ROCAUC(test_y, prediction)
</span></span></code></pre></div><p><img src="./NN_Hospital_Attendance_33_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>precision, recall, thresholds <span style="color:#f92672">=</span> precision_recall_curve(test_y, prediction)
</span></span><span style="display:flex;"><span>plot_precision_recall()
</span></span></code></pre></div><p><img src="./NN_Hospital_Attendance_34_0.png" alt="png"></p>
<p>The model is doing an okay job the ROC AUC is 0.72, but the PR AUC is 0.35&hellip; not too hot.</p>
<p><img src="/img/under_construction.png" alt=""></p>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="https://hzorkic.github.io/js/jquery.min.js"></script>
<script src="https://hzorkic.github.io/js/bootstrap.min.js"></script>
<script src="https://hzorkic.github.io/js/jquery.cookie.js"> </script>
<script src="https://hzorkic.github.io/js/ekko-lightbox.js"></script>
<script src="https://hzorkic.github.io/js/jquery.scrollTo.min.js"></script>
<script src="https://hzorkic.github.io/js/masonry.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/imagesloaded.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/owl.carousel.min.js"></script>
<script src="https://hzorkic.github.io/js/front.js"></script>



</body>
</html>
