<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Zora Zorkiƒá</title>
<meta name="description" content="The personal website of Zora Zorkiƒá">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://hzorkic.github.io/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="https://hzorkic.github.io/css/font-awesome.min.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.carousel.css">
<link rel="stylesheet" href="https://hzorkic.github.io/css/owl.theme.css">


  <link href="https://hzorkic.github.io/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://hzorkic.github.io/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://hzorkic.github.io/img/favicon.png">



 
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.1/jquery.min.js" ></script> 

<script type="text/javascript" src="js/bigfoot.js"></script> 
<link rel="stylesheet" type="text/css" href="css/bigfoot.css"> 

<script type="text/javascript"> $.bigfoot(); </script> 
</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content" >
    
    <h1 class="sidebar-heading">
      <div class="hidden-xs"><img style="max-width: 70%; margin-bottom: 15px;  height: auto; border: 2px black solid; border-radius: 190px; max-height: 300px" src="/img/prof.png" alt=""></div>
      
      <a href="https://hzorkic.github.io/">
        
        <img src="https://see.fontimg.com/api/renderfont4/GOZEP/eyJyIjoiZnMiLCJoIjo2NSwidyI6MTAwMCwiZnMiOjY1LCJmZ2MiOiIjMDAwMDAwIiwiYmdjIjoiI0ZGRkZGRiIsInQiOjF9/em9yYSB6b3JraWM/sizelademo-regular.png" alt="Prehistoric fonts" style="height: auto; max-height: 80%; max-width: 100%; margin-bottom: 20px;">
      </a>
    </h1>
    
    
      <p class="sidebar-p" style="margin-bottom: 2px; ">Data Scientist.</p>
    
      <p class="sidebar-p" style="margin-bottom: 2px; ">UX Researcher.</p>
    
    
    
      <p class="sidebar-p" style="margin-top: 20px; "\>üìç Somewhere between Austin and San Diego </p>
    
    
   
    <ul class="sidebar-menu" style="margin-top: 20px; ">
      
        <li><a href="https://hzorkic.github.io/about/">About</a></li>
      
        <li><a href="https://hzorkic.github.io/portfolio/">Portfolio</a></li>
      
        <li><a href="https://hzorkic.github.io/technical/">Blog</a></li>
      
        <li><a href="https://docs.google.com/document/d/1kj4knE2wdZdFEqjAO-J8EwKpLbXFVES-eprmV8g3lqs/edit?usp=sharing">CV</a></li>
      
      
      
    </ul>
    <p class="social">
  
  
  
  
  
  <a href="mailto:hayley.zorkic@gmail.com" data-animate-hover="pulse" class="email" title="E-mail">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/hayley-zorkic" data-animate-hover="pulse" class="external" title="LinkedIn" rel="me">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  <a href="https://github.com/hzorkic" data-animate-hover="pulse" class="external" title="GitHub" rel="me">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
</p>

      <div class="copyright" style="font-size: 2px;">
        
      </div>
    
    
    

    
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost">
    <i class="fa fa-bars"></i>
  </button>
  <h1 class="small-navbar-heading">
    <a href="https://hzorkic.github.io/">
      <img src="https://see.fontimg.com/api/renderfont4/GOZEP/eyJyIjoiZnMiLCJoIjo2NSwidyI6MTAwMCwiZnMiOjY1LCJmZ2MiOiIjMDAwMDAwIiwiYmdjIjoiI0ZGRkZGRiIsInQiOjF9/em9yYSB6b3JraWM/sizelademo-regular.png"
      style="max-height:30px;">
    </a>
  </h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Computer-Aided Yoga</h1>
         <p><img src="https://ak.picdn.net/shutterstock/videos/782587/thumb/1.jpg" alt="robot doing seated meditation"></p>
<h3 id="introduction">Introduction</h3>
<p>In my final semester of college, I had already completed all my course requirements, so I had the opportunity to enroll in some <em>fun</em> classes. I enrolled in Startitical Learning, Natural Language Processing, Advanced Regression Analysis, and Introduction to Yoga. Can you choose the item that doesn&rsquo;t belong in this list? If you chose Yoga, you&rsquo;re technically correct, however, I decided to merge my knowledge of Machine Learning and love for Yoga for my final project to creatively represent what Yoga means to me.</p>
<p><strong>The Plan</strong></p>
<p>In this post, I am going to show how I developed a program that can detect and classify yoga poses from recorded or a live video stream! I took pre-recorded videos of my instructor <a href="https://education.utexas.edu/faculty/zoe_mantarakis">Zoe Mantarakis</a> and trained a model to identify yoga poses in a live video feed based on the angles of her body.</p>
<p><img src="track.gif" alt="picture of girl doing yoga with her joints getting tracked"></p>
<p><strong>The Motivation</strong></p>
<p>In class we learned <a href="https://en.wikipedia.org/wiki/Ashtanga_(eight_limbs_of_yoga)#:~:text=The%20eight%20limbs%20of%20yoga%20are%20yama%20(abstinences)%2C%20niyama,and%20samadhi%20(absorption).%22">the 8 limbs of yoga</a>. I believe the process of creating this project as well as what it can be used for firmly reflect the 8 limbs of yoga, which I will expand on below:</p>
<ol>
<li>
<p>First: <strong>Yama (moral discipline)</strong>. The world of coding at large heavily relies on pre-made resources and tutorials. Full transparency, I heavily relied on an online tutorial and Zoe&rsquo;s content in order to make this a reality. To respect the Yamas, I have ensured to cite the sources that inspired my code chunks, as well as only use these resources when I absolutely could not figure out what to do.</p>
</li>
<li>
<p>Second: <strong>Niyama (self-discipline)</strong>. One limb of Yoga I particularly resonated with was the Niyamas- the positive duties of an individual. There are 5 Niymas: &ldquo;keep it clean&rdquo;, &ldquo;contentment&rdquo;, &ldquo;willingness to do hard work&rdquo;, &ldquo;consult an expert&rdquo;, and &ldquo;trust the universe&rdquo;. In this project, I showed my <strong>willingness to do hardwork</strong> and <strong>keep it clean</strong> by fully implementing a realtively complex algorithm that I have never worked with before. In various steps throughout this project, I had to <strong>consult experts</strong> on the internet for giudance. In coding projects, it is very easy to <em>keep going</em>, but I had to practice <strong>contentment</strong> with my final product and stop once I completed my initial task.</p>
</li>
<li>
<p>Third: <strong>Asana (Poses)</strong>. This project heavily relies on the yoga poses. Through studying the poses we learned and quantifying various angles of the body in my reference videos, I developed an intimate understanding of a few of the postures involved in yoga.</p>
</li>
<li>
<p>Fourth: <strong>Pranayama (Breath)</strong>. A key element of yoga is focusing on the connection between the breath, mind, and body. This project helps users develop confidence around the poses they are performing such that they can focus on breathing through poses, not just physically achieveing them.</p>
</li>
<li>
<p>Fifth: <strong>Pratyahara (Withdrawing the senses)</strong>. As I mentioned before, this was my first time completing a computer vision project. When I noticed I began feeling overwhelmed with the various tasks at hand, I took a step back to look at my surroudings. I found that it was incredibly stressful to code in public settings with lots of noise and movement while mutlitasking- it severly impacted my productivity consciously and subconsciously. I adapted and tried to respect the 5th limb by using noise cancelling headphones, ensuring I maintained my focus ont he project and not my surroundings, and coding very early in the morning so I could eliminate distractions.</p>
</li>
<li>
<p>Sixth: <strong>Dharana (Concentration)</strong>. Even when I eliminated external distractions, I still could not fully concentrate on coding as there were several mental distractions that were competing for my attention. To help increase my mental concentration, I set a timer every 30 minutes to take a quick break- a technique that is scientifically proven to increase concentration.</p>
</li>
<li>
<p>Seventh: <strong>Dhyana (Meditation)</strong>. Several psychology academics reference a &ldquo;flow state&rdquo; which is defined as a state of mind in which a person becomes fully immersed in an activity. I can honestly say that approaching this project as a yogi allowed me to reach a flow state much faster than if I was just approaching it as a programmer. There were times when I was completly focused on this project and had to skip my concentration breaks to not break the flow state I was in.</p>
</li>
<li>
<p>Eighth: <strong>Samadhi (Enlightenment)</strong>. In no way can I claim that this project helped me reach enlightenment at any point, however, in the process of getting into a flow state and working on a project that I care deeply about, I definitely felt like my optimal self.</p>
</li>
</ol>
<p>I hope you enjoy this post, and as always&hellip; <strong>namaste</strong>.</p>
<h3 id="build-our-model">Build our Model</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># import libraries</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> mediapipe <span style="color:#66d9ef">as</span> mp
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time <span style="color:#66d9ef">as</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span></code></pre></div><p><strong>Initialize the Pose Detection Model</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># initialize the pose detection model</span>
</span></span><span style="display:flex;"><span>mp_pose <span style="color:#f92672">=</span> mp<span style="color:#f92672">.</span>solutions<span style="color:#f92672">.</span>pose
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># setup pose function</span>
</span></span><span style="display:flex;"><span>pose <span style="color:#f92672">=</span> mp_pose<span style="color:#f92672">.</span>Pose(static_image_mode<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, \
</span></span><span style="display:flex;"><span>                   min_detection_confidence<span style="color:#f92672">=</span><span style="color:#ae81ff">0.3</span>, \
</span></span><span style="display:flex;"><span>                   model_complexity<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># initialize mediapipe draw class to annotate body edges and verticies</span>
</span></span><span style="display:flex;"><span>mp_drawing <span style="color:#f92672">=</span> mp<span style="color:#f92672">.</span>solutions<span style="color:#f92672">.</span>drawing_utils
</span></span></code></pre></div><p><strong>Read in an Image</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># read an image from our data folder</span>
</span></span><span style="display:flex;"><span>sample_img <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/triangle.png&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># resize the picture</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># display the sample</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Sample Image&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>imshow(sample_img[:,:,::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><pre><code>INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
</code></pre>
<p><img src="output_6_1.png" alt="png"></p>
<p><strong>Detect Pose</strong></p>
<p>Now that we know we can pull images from our data folder and display them, we need to find out the body joint locations. In order to quantify what exactly a pose like &ldquo;downward dog&rdquo; is, we need to locate each joint in the body of a training image and find the angles between these joints. Then, we can use these references in order to classify new images or live video!</p>
<p>First let&rsquo;s try to vizualize landmarks in 2 dimentions (static images).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># detect pose after covnerting image color (pose.process() takes RGB not BGR)</span>
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> pose<span style="color:#f92672">.</span>process(cv2<span style="color:#f92672">.</span>cvtColor(sample_img, cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create a copy of the sample image that we can draw on</span>
</span></span><span style="display:flex;"><span>img_copy <span style="color:#f92672">=</span> sample_img<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check for landmarks</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> results<span style="color:#f92672">.</span>pose_landmarks:
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># draw pose landmarks on image</span>
</span></span><span style="display:flex;"><span>    mp_drawing<span style="color:#f92672">.</span>draw_landmarks(image<span style="color:#f92672">=</span>img_copy, \
</span></span><span style="display:flex;"><span>                              landmark_list<span style="color:#f92672">=</span>results<span style="color:#f92672">.</span>pose_landmarks, \
</span></span><span style="display:flex;"><span>                              connections<span style="color:#f92672">=</span>mp_pose<span style="color:#f92672">.</span>POSE_CONNECTIONS)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># resize image</span>
</span></span><span style="display:flex;"><span>    fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure(figsize <span style="color:#f92672">=</span> [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># display the image WITH the annotations also convert back to RGB</span>
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Output&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>imshow(img_copy[:,:,::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><p><img src="output_9_0.png" alt="png"></p>
<p>Now let&rsquo;s try to vizualize landmarks in 3 dimentions (transform the points into 3D).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># plot pose landmarks in 3D</span>
</span></span><span style="display:flex;"><span>mp_drawing<span style="color:#f92672">.</span>plot_landmarks(results<span style="color:#f92672">.</span>pose_world_landmarks, \
</span></span><span style="display:flex;"><span>                          mp_pose<span style="color:#f92672">.</span>POSE_CONNECTIONS)
</span></span></code></pre></div><p><img src="output_11_0.png" alt="png"></p>
<p><strong>Create a Pose Detection Fucntion</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">detectPose</span>(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create a copy fo the input image</span>
</span></span><span style="display:flex;"><span>    output_image <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># convert the image from BGR to RGB</span>
</span></span><span style="display:flex;"><span>    imageRGB <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>cvtColor(image, cv2<span style="color:#f92672">.</span>COLOR_BGR2RGB)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># perform the pose detection</span>
</span></span><span style="display:flex;"><span>    results <span style="color:#f92672">=</span> pose<span style="color:#f92672">.</span>process(imageRGB)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># get the height and width of the original image</span>
</span></span><span style="display:flex;"><span>    height, width, _ <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span>shape
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># initialize a list to store the detected landmarks</span>
</span></span><span style="display:flex;"><span>    landmarks <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># check if we detected any landmarks</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> results<span style="color:#f92672">.</span>pose_landmarks:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Draw Pose landmarks on the output image</span>
</span></span><span style="display:flex;"><span>        mp_drawing<span style="color:#f92672">.</span>draw_landmarks(image<span style="color:#f92672">=</span>output_image, \
</span></span><span style="display:flex;"><span>                                 landmark_list <span style="color:#f92672">=</span> results<span style="color:#f92672">.</span>pose_landmarks, \
</span></span><span style="display:flex;"><span>                                 connections<span style="color:#f92672">=</span>mp_pose<span style="color:#f92672">.</span>POSE_CONNECTIONS)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># iterate through all detected landmarks</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> landmark <span style="color:#f92672">in</span> results<span style="color:#f92672">.</span>pose_landmarks<span style="color:#f92672">.</span>landmark:
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Append the landmark into the list</span>
</span></span><span style="display:flex;"><span>            landmarks<span style="color:#f92672">.</span>append((int(landmark<span style="color:#f92672">.</span>x <span style="color:#f92672">*</span> width), \
</span></span><span style="display:flex;"><span>                              int(landmark<span style="color:#f92672">.</span>y <span style="color:#f92672">*</span> height), \
</span></span><span style="display:flex;"><span>                                 (landmark<span style="color:#f92672">.</span>z <span style="color:#f92672">*</span> width)))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># if display parameter is = True        </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> display:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># display the original input image AND annotated image</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>[<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">22</span>])
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">## Original Image</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">121</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>imshow(image[:,:,::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Original Image&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">## Annotated Image</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">122</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>imshow(output_image[:,:,::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Original Image&#34;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#34;off&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">## plot the pose landmarks in 3D (optional)</span>
</span></span><span style="display:flex;"><span>        mp_drawing<span style="color:#f92672">.</span>plot_landmarks(results<span style="color:#f92672">.</span>pose_world_landmarks, \
</span></span><span style="display:flex;"><span>                                 mp_pose<span style="color:#f92672">.</span>POSE_CONNECTIONS)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># if display parameter is = False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># return only the output image and landmarks</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> output_image, landmarks
</span></span></code></pre></div><p>Let&rsquo;s test it out&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># seated forward fold </span>
</span></span><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/standing_forward_fold.png&#39;</span>)
</span></span><span style="display:flex;"><span>detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_15_0.png" alt="png"></p>
<p><img src="output_15_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># seated forward fold </span>
</span></span><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/happy_baby.png&#39;</span>)
</span></span><span style="display:flex;"><span>detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_16_0.png" alt="png"></p>
<p><img src="output_16_1.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># mountain pose </span>
</span></span><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/mountain_pose.png&#39;</span>)
</span></span><span style="display:flex;"><span>detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_17_0.png" alt="png"></p>
<p><img src="output_17_1.png" alt="png"></p>
<p><strong>Now lets try to find pose landmarks on real-time video</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;# create pose function for video
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">pose_video = mp_pose.Pose(static_image_mode=False, </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                         min_detection_confidence=0.5, </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                         model_complexity=1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># initialize VideoCapture so we can read from the webcam
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#video = cv2.VideoCapture(0)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># alternatively, you can use a video stored locally
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># initialize VideoCapture so we can read from the disk
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">video = cv2.VideoCapture(&#39;data/downward_dog.mp4&#39;) # create named window
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># initialize a vairable to store prior frame time
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">time1 = 0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># iterate intul we access the video 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">while video.isOpened():
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # read 1 frame
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ok, frame = video.read()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # check if frame is not read properly
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    if not ok:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        break
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # Flip frame hoizontally for natural vizulaization 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    frame = cv2.flip(frame, 1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # Get the width and height of frame
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    frame_height, frame_width, _ = frame.shape
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # resize the frame, but keep aspect ratio
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    frame = cv2.resize(frame, </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                       (int(frame_width*(640 / frame_height)), </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                        640))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # pose landmark detection
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    frame, _ = detectPose(frame, pose_video, display=False)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # Make sure we get the correct FPS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    time2 = time.time()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    if (time2 - time1) &gt; 0:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        frames_per_second = 1.0 / (time2 - time1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        cv2.putText(frame, &#39;FPS: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#39;.format(int(frames_per_second)), </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">                    (10,30), cv2.FONT_HERSHEY_PLAIN, 2, (0, 225, 0), 3)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    time1 = time2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    # display the frame 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    cv2.imshow(&#39;Pose Detection&#39;, frame)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    k = cv2.waitKey(1) &amp; 0xFF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    if (k == 27):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        break 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">video.release()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">cv2.destroyAllWindows()&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        
</span></span></code></pre></div><pre><code>&quot;# create pose function for video\npose_video = mp_pose.Pose(static_image_mode=False,                          min_detection_confidence=0.5,                          model_complexity=1)\n\n# initialize VideoCapture so we can read from the webcam\n#video = cv2.VideoCapture(0)\n\n# alternatively, you can use a video stored locally\n# initialize VideoCapture so we can read from the disk\nvideo = cv2.VideoCapture('data/downward_dog.mp4') # create named window\n\n# initialize a vairable to store prior frame time\ntime1 = 0\n\n# iterate intul we access the video \nwhile video.isOpened():\n    \n    # read 1 frame\n    ok, frame = video.read()\n    \n    # check if frame is not read properly\n    if not ok:\n        \n        break\n    \n    # Flip frame hoizontally for natural vizulaization \n    frame = cv2.flip(frame, 1)\n    \n    # Get the width and height of frame\n    frame_height, frame_width, _ = frame.shape\n    \n    # resize the frame, but keep aspect ratio\n    frame = cv2.resize(frame,                        (int(frame_width*(640 / frame_height)),                         640))\n    \n    # pose landmark detection\n    frame, _ = detectPose(frame, pose_video, display=False)\n    \n    # Make sure we get the correct FPS\n    time2 = time.time()\n    if (time2 - time1) &gt; 0:\n        frames_per_second = 1.0 / (time2 - time1)\n        cv2.putText(frame, 'FPS: {}'.format(int(frames_per_second)),                     (10,30), cv2.FONT_HERSHEY_PLAIN, 2, (0, 225, 0), 3)\n    time1 = time2\n    \n    # display the frame \n    cv2.imshow('Pose Detection', frame)\n    \n    k = cv2.waitKey(1) &amp; 0xFF\n    \n    if (k == 27):\n        break \n        \n        \nvideo.release()\ncv2.destroyAllWindows()&quot;
</code></pre>
<h3 id="pose-classification-using-angles">Pose Classification using Angles</h3>
<p>Now that we can detect where certain body joints are, we need to build some yoga pose classifiers based on the body angles in various joints.</p>
<p><strong>Create function to calculate the angle between land</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">calculateAngle</span>(landmark1, landmark2, landmark3):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># get the landmark coordinates</span>
</span></span><span style="display:flex;"><span>    x1, y1, _ <span style="color:#f92672">=</span> landmark1
</span></span><span style="display:flex;"><span>    x2, y2, _ <span style="color:#f92672">=</span> landmark2
</span></span><span style="display:flex;"><span>    x3, y3, _ <span style="color:#f92672">=</span> landmark3
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># calculate the angle</span>
</span></span><span style="display:flex;"><span>    angle <span style="color:#f92672">=</span> math<span style="color:#f92672">.</span>degrees(math<span style="color:#f92672">.</span>atan2(y3<span style="color:#f92672">-</span>y2, x3<span style="color:#f92672">-</span>x2) <span style="color:#f92672">-</span> math<span style="color:#f92672">.</span>atan2(y1<span style="color:#f92672">-</span>y2, x1<span style="color:#f92672">-</span>x2))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># check if angle is less than zero</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># add 360 deg to found angle</span>
</span></span><span style="display:flex;"><span>        angle <span style="color:#f92672">+=</span> <span style="color:#ae81ff">360</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># return calculated angle</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> angle
</span></span><span style="display:flex;"><span>        
</span></span></code></pre></div><p><strong>Create a function to perform pose classification</strong></p>
<p>In the next part of this video, we will create classifiers for the following poses covered in class:</p>
<ul>
<li>Warrior II</li>
<li>Mountain Pose</li>
<li>Triangle</li>
<li>Tree</li>
<li>Downward Dog</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">classifyPose</span>(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>):
</span></span><span style="display:flex;"><span>    label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unknown Pose&#34;</span>
</span></span><span style="display:flex;"><span>    color <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#################################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># calculate the required angles #</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#################################</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># angle between left shoulder, elbow, and wrist</span>
</span></span><span style="display:flex;"><span>    left_elbow_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_ELBOW<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_WRIST<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the right shoulder, elbow and wrist points. </span>
</span></span><span style="display:flex;"><span>    right_elbow_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                       landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_ELBOW<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                       landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_WRIST<span style="color:#f92672">.</span>value])   
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the left elbow, shoulder and hip points. </span>
</span></span><span style="display:flex;"><span>    left_shoulder_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_ELBOW<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                         landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                         landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_HIP<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the right hip, shoulder and elbow points. </span>
</span></span><span style="display:flex;"><span>    right_shoulder_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_HIP<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                          landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                          landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_ELBOW<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the left hip, knee and ankle points. </span>
</span></span><span style="display:flex;"><span>    left_knee_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_HIP<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                     landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_KNEE<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                     landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_ANKLE<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the right hip, knee and ankle points </span>
</span></span><span style="display:flex;"><span>    right_knee_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_HIP<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_KNEE<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_ANKLE<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the right shoulder, hip, and knee points</span>
</span></span><span style="display:flex;"><span>    right_hip_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_HIP<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>RIGHT_KNEE<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the angle between the left shoulder, hip, and knee points</span>
</span></span><span style="display:flex;"><span>    left_hip_angle <span style="color:#f92672">=</span> calculateAngle(landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_SHOULDER<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_HIP<span style="color:#f92672">.</span>value], \
</span></span><span style="display:flex;"><span>                                      landmarks[mp_pose<span style="color:#f92672">.</span>PoseLandmark<span style="color:#f92672">.</span>LEFT_KNEE<span style="color:#f92672">.</span>value])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># check for poses #</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">###################</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Mountain Pose ----------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># straight arms:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> left_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">130</span> <span style="color:#f92672">and</span> left_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">130</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># arms by side</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> left_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">and</span> left_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">60</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">60</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># legs straight:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">160</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">160</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>                label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Mountain Pose&#39;</span> 
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Tree Pose --------------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if one leg is straight</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check if the other leg is bended at the required angle.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">315</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">335</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">25</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">45</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Specify the label of the pose that is tree pose.</span>
</span></span><span style="display:flex;"><span>            label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Tree Pose&#39;</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Warrior I Pose ----------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># straight arms:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> left_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> left_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># arms straight up:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> left_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">120</span> <span style="color:#f92672">and</span> left_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">120</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">200</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Check if one leg is straight.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">140</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">140</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Check if the other leg is bended at the required angle.</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">80</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">80</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Specify the label of the pose that is Warrior II pose.</span>
</span></span><span style="display:flex;"><span>                    label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Warrior I Pose&#39;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Warrior II ----------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the both arms are straight.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> left_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> left_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check if shoulders are at the required angle.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> left_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">70</span> <span style="color:#f92672">and</span> left_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">70</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Check if one leg is straight.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">165</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Check if the other leg is bended at the required angle.</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">90</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">120</span> <span style="color:#f92672">or</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">90</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">120</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e"># Specify the label of the pose that is Warrior II pose.</span>
</span></span><span style="display:flex;"><span>                    label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Warrior II Pose&#39;</span> 
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Triangle ------------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the both arms are straight.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> left_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> left_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> right_elbow_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check if shoulders are at the required angle.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> left_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">50</span> <span style="color:#f92672">and</span> left_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">50</span> <span style="color:#f92672">and</span> right_shoulder_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">140</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># legs straight:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> left_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> left_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150</span> <span style="color:#f92672">and</span> right_knee_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">195</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> right_hip_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">90</span> <span style="color:#f92672">and</span> right_hip_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">170</span> <span style="color:#f92672">or</span> left_hip_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">90</span> <span style="color:#f92672">and</span> left_hip_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">170</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> right_hip_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">and</span> right_hip_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">110</span> <span style="color:#f92672">or</span> left_hip_angle <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">and</span> left_hip_angle <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">110</span>:
</span></span><span style="display:flex;"><span>                        label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Triangle Pose&#39;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#----------------------------------------------------------------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the pose is classified successfully</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> label <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;Unknown Pose&#39;</span>:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Update the color (to green) with which the label will be written on the image.</span>
</span></span><span style="display:flex;"><span>        color <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">0</span>)  
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Write the label on the output image. </span>
</span></span><span style="display:flex;"><span>    cv2<span style="color:#f92672">.</span>putText(output_image, label, (<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">30</span>),cv2<span style="color:#f92672">.</span>FONT_HERSHEY_PLAIN, <span style="color:#ae81ff">2</span>, color, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the resultant image is specified to be displayed.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> display:
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Display the resultant image.</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>[<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span>])
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>imshow(output_image[:,:,::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]);plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#34;Output Image&#34;</span>);plt<span style="color:#f92672">.</span>axis(<span style="color:#e6db74">&#39;off&#39;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Return the output image and the classified label.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> output_image, label
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><h3 id="test-the-model">Test the Model</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/mountain_pose.png&#39;</span>)
</span></span><span style="display:flex;"><span>output_image, landmarks <span style="color:#f92672">=</span> detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>    classifyPose(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_26_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/tree_pose.png&#39;</span>)
</span></span><span style="display:flex;"><span>output_image, landmarks <span style="color:#f92672">=</span> detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>    classifyPose(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_27_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/warrior_1.jpeg&#39;</span>)
</span></span><span style="display:flex;"><span>output_image, landmarks <span style="color:#f92672">=</span> detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>    classifyPose(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_28_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/warrior_2.png&#39;</span>)
</span></span><span style="display:flex;"><span>output_image, landmarks <span style="color:#f92672">=</span> detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>    classifyPose(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_29_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>image <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(<span style="color:#e6db74">&#39;data/triangle.jpeg&#39;</span>)
</span></span><span style="display:flex;"><span>output_image, landmarks <span style="color:#f92672">=</span> detectPose(image, pose, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>    classifyPose(landmarks, output_image, display<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p><img src="output_30_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Setup Pose function for video.</span>
</span></span><span style="display:flex;"><span>pose_video <span style="color:#f92672">=</span> mp_pose<span style="color:#f92672">.</span>Pose(static_image_mode<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, \
</span></span><span style="display:flex;"><span>                          min_detection_confidence<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>, \
</span></span><span style="display:flex;"><span>                          model_complexity<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>camera_video <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>VideoCapture(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize a resizable window.</span>
</span></span><span style="display:flex;"><span>cv2<span style="color:#f92672">.</span>namedWindow(<span style="color:#e6db74">&#39;Pose Classification&#39;</span>, cv2<span style="color:#f92672">.</span>WINDOW_NORMAL)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Iterate until the webcam is accessed successfully.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> camera_video<span style="color:#f92672">.</span>isOpened():
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Read a frame.</span>
</span></span><span style="display:flex;"><span>    ok, frame <span style="color:#f92672">=</span> camera_video<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if frame is not read properly.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> ok:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Continue to the next iteration to read the next frame and ignore the empty camera frame.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Flip the frame horizontally for natural (selfie-view) visualization.</span>
</span></span><span style="display:flex;"><span>    frame <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>flip(frame, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get the width and height of the frame</span>
</span></span><span style="display:flex;"><span>    frame_height, frame_width, _ <span style="color:#f92672">=</span>  frame<span style="color:#f92672">.</span>shape
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Resize the frame while keeping the aspect ratio.</span>
</span></span><span style="display:flex;"><span>    frame <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>resize(frame, (int(frame_width <span style="color:#f92672">*</span> (<span style="color:#ae81ff">640</span> <span style="color:#f92672">/</span> frame_height)), <span style="color:#ae81ff">640</span>))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Perform Pose landmark detection.</span>
</span></span><span style="display:flex;"><span>    frame, landmarks <span style="color:#f92672">=</span> detectPose(frame, pose_video, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if the landmarks are detected.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> landmarks:
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Perform the Pose Classification.</span>
</span></span><span style="display:flex;"><span>        frame, _ <span style="color:#f92672">=</span> classifyPose(landmarks, frame, display<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Display the frame.</span>
</span></span><span style="display:flex;"><span>    cv2<span style="color:#f92672">.</span>imshow(<span style="color:#e6db74">&#39;Pose Classification&#39;</span>, frame)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Wait until a key is pressed.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Retreive the ASCII code of the key pressed</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>waitKey(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Check if &#39;ESC&#39; is pressed.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(k <span style="color:#f92672">==</span> <span style="color:#ae81ff">27</span>):
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Break the loop.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Release the VideoCapture object and close the windows.</span>
</span></span><span style="display:flex;"><span>        camera_video<span style="color:#f92672">.</span>release()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cv2<span style="color:#f92672">.</span>destroyAllWindows()
</span></span></code></pre></div><h3 id="resources">Resources</h3>
<ul>
<li><a href="https://towardsdatascience.com/video-streaming-in-the-jupyter-notebook-635bc5809e85">How to implement live video streaming in Jupyter Notebook</a></li>
<li><a href="https://www.analyticsvidhya.com/blog/2021/05/pose-estimation-using-opencv/">Workout pose estimation using OpenCV</a></li>
<li><a href="https://www.youtube.com/watch?v=aySurynUNAw">Most of the Code base came here</a></li>
</ul>

         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="https://hzorkic.github.io/js/jquery.min.js"></script>
<script src="https://hzorkic.github.io/js/bootstrap.min.js"></script>
<script src="https://hzorkic.github.io/js/jquery.cookie.js"> </script>
<script src="https://hzorkic.github.io/js/ekko-lightbox.js"></script>
<script src="https://hzorkic.github.io/js/jquery.scrollTo.min.js"></script>
<script src="https://hzorkic.github.io/js/masonry.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/imagesloaded.pkgd.min.js"></script>
<script src="https://hzorkic.github.io/js/owl.carousel.min.js"></script>
<script src="https://hzorkic.github.io/js/front.js"></script>



</body>
</html>
